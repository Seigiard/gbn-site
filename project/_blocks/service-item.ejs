<%
  function stripHtml(html) {
    return (html || '').replace(/<(?:.|\n)*?>/gm, '').replace(/\n/gm, '');
  }

  function formatPrice(htmlString) {
    if (htmlString.includes('<ul>')) {
      return htmlString;
    }
    const priceString = stripHtml(htmlString).replace(/\s+/gm, '');
    const priceValue = priceString.slice(-1);
    const price = priceString.slice(0, -1).replace(/(\d)(?=(\d{3})$)/g, '$1<span class="hs"></span>');

    return `${price}<span class="rhs">&nbsp;</span>${priceValue}`;
  }

  const [ title, price, description, info ] = (data || '').split('<hr>');
  const formattedPrice = formatPrice(price);
  const strippedTitle = stripHtml(title);

  const checkbox = new Date().getTime();
%>
<div class="service-item">
  <label class="service-item--checkbox" for="serviceItem<%- id %>"><input type="checkbox" checked name="serviceItem<%- id %>" id="serviceItem<%- id %>"><span></span></label>
  <h3><label for="serviceItem<%- id %>"><%- strippedTitle %></label></h3>
  <%- description %>
  <% if (info) { %>
    <div class="service-item--info info">
      <button class="info--toggle" title="Дополнительная информация">
        <svg width="20px" height="10px" viewBox="0 0 20 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g stroke="none" fill="none" fill-rule="evenodd">
            <rect class="iconToggle--border" stroke="#C5C5C5" stroke-width="1" x="0.5" y="0.5" width="19" height="9" rx="4.5"></rect>
            <path class="iconToggle--dots" fill="#000000" d="M14,6 C13.4477153,6 13,5.55228475 13,5 C13,4.44771525 13.4477153,4 14,4 C14.5522847,4 15,4.44771525 15,5 C15,5.55228475 14.5522847,6 14,6 Z M10,6 C9.44771525,6 9,5.55228475 9,5 C9,4.44771525 9.44771525,4 10,4 C10.5522847,4 11,4.44771525 11,5 C11,5.55228475 10.5522847,6 10,6 Z M6,6 C5.44771525,6 5,5.55228475 5,5 C5,4.44771525 5.44771525,4 6,4 C6.55228475,4 7,4.44771525 7,5 C7,5.55228475 6.55228475,6 6,6 Z"></path>
          </g>
        </svg>
      </button>
      <div class="info--content"><%- info %></div>
    </div>
  <% } %>

  <div class="service-item--price"><%- formattedPrice %></div>
</div>